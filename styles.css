/*  White Nights / MAX WebApp — Black–Blue WOW UI (v3)
    Drop‑in upgrade for v2. Focused on a11y, perf, and consistency.
    Usage: <link rel="stylesheet" href="max-black-blue.css">  */

/* ===== System & Theme Tokens ===== */
:root{
  color-scheme: dark light;
  --bg:    color-mix(in srgb, #070c14 92%, black);
  --bg2:   #0a1220;
  --panel: color-mix(in srgb, #0c1220 78%, #0b0f19);
  --elev:  rgba(12,18,32,.92);
  --border:#1b2a44; --border-strong:#274165;
  --text:#eaf1fb; --muted:#9fb1cc; --muted-2:#7f90aa;
  --acc1:#2fa2ff; --acc2:#675bff; --good:#22c55e; --warn:#f59e0b; --err:#ef4444;
  --glow:#2fa2ff30; --glow-2:#675bff24;
  --shadow:0 14px 40px #000a, 0 2px 0 #0002;
  --radius:16px; --radius-sm:12px; --radius-lg:22px;
  --focus:#3b82f6; --focus-ring:0 0 0 3px #3b82f633;
  --inset:inset 0 1px 0 #ffffff1a;
  --blur:12px;
  --sbw:10px; /* scrollbar width */
  --speed-fast:.12s; --speed:.2s; --speed-slow:.32s;
}
/* Telegram theme variable bridges (no‑ops if absent) */
:root{
  --tg-bg: var(--tg-theme-bg-color, var(--bg));
  --tg-text: var(--tg-theme-text-color, var(--text));
  --tg-button: var(--tg-theme-button-color, var(--acc2));
  --tg-button-text: var(--tg-theme-button-text-color, #fff);
}
@media (prefers-color-scheme: light){
  :root{
    --bg:#f6f8fc; --bg2:#eef3ff;
    --panel:rgba(255,255,255,.84); --elev:#fff;
    --border:#d7e1f2; --border-strong:#c3d2ef;
    --text:#0b1220; --muted:#4b5a72; --muted-2:#64748b;
    --glow:#2fa2ff20; --glow-2:#675bff18;
    --shadow:0 8px 26px #0010291a;
  }
}
:root.tg-compact{ --radius:14px; --radius-sm:10px }

/* ===== Base ===== */
*{box-sizing:border-box}
html,body{height:100%;margin:0}
body{
  color:var(--tg-text); font:15px/1.45 system-ui, Segoe UI, Roboto, Arial, sans-serif;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  background:
    radial-gradient(1200px 800px at 110% -10%, #1b2a42 0%, transparent 55%),
    radial-gradient(1000px 620px at -8% 112%, #13253f 0%, transparent 60%),
    linear-gradient(180deg, var(--tg-bg), var(--bg2));
  background-attachment: fixed, fixed, fixed;
  animation:bgMove 18s ease-in-out infinite alternate;
}
@keyframes bgMove{to{background-position:12% 0, 88% 100%, 0 0}}

.app{max-width:980px;margin-inline:auto;padding:16px;min-height:100vh;height:100vh;display:flex;flex-direction:column;gap:14px;animation:fadeIn var(--speed-fast) ease-out}
@supports(height:100svh){.app{min-height:100svh;height:100svh;padding-top:calc(16px + env(safe-area-inset-top));padding-bottom:calc(16px + env(safe-area-inset-bottom))}}
@keyframes fadeIn{from{opacity:0;transform:translateY(6px)}}

.hidden{display:none!important}
.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}

/* ===== Headings ===== */
h1,h2{margin:0 0 10px}
h1{font-size:22px;letter-spacing:.2px}
h2{font-size:18px;color:var(--muted)}

/* ===== Grid ===== */
.grid{display:grid;gap:12px;grid-template-columns:repeat(2,1fr)}
@media (min-width:640px){.grid{grid-template-columns:repeat(3,1fr)}}
@media (max-width:520px){.grid{grid-template-columns:1fr}}

/* ===== Card / Panel ===== */
.card{
  position:relative; overflow:hidden;
  background:var(--panel); border:1px solid var(--border); border-radius:var(--radius);
  padding:16px; display:flex; flex-direction:column; gap:12px;
  box-shadow:var(--shadow), var(--inset);
  backdrop-filter:saturate(120%) blur(var(--blur));
  -webkit-backdrop-filter:saturate(120%) blur(var(--blur));
  animation:cardIn var(--speed) cubic-bezier(.2,.8,.2,1) both;
  contain:content; /* isolate heavy effects */
}
.card.compact{padding:12px;border-radius:var(--radius-sm)}
.card::before{
  content:""; position:absolute; inset:-1px; pointer-events:none;
  background:conic-gradient(from 220deg at 10% -20%, transparent, #ffffff22 18%, transparent 40%);
  mix-blend-mode:overlay; animation:shine 5s ease-in-out infinite;
}
@keyframes cardIn{from{opacity:0; transform:translateY(8px) scale(.98)}}
@keyframes shine{50%{opacity:.35; transform:translate3d(2px,0,0)}}
.card .back{position:sticky;bottom:0;z-index:1;margin-top:8px}

/* ===== Inputs ===== */
label{display:block;margin:8px 0 6px;color:var(--muted);font-size:13px}
:where(input,button,select,textarea){
  inline-size:100%; border-radius:var(--radius-sm);
  border:1px solid var(--border);
  color:var(--tg-text);
  background:linear-gradient(180deg,#0f1728,#0c1424);
  padding:12px 14px;
  transition:transform var(--speed-fast) ease, box-shadow var(--speed) ease, border-color var(--speed) ease, background var(--speed) ease, filter var(--speed) ease;
}
input::placeholder,textarea::placeholder{color:var(--muted-2)}
:where(input,select,textarea):focus-visible{outline:none;border-color:var(--focus);box-shadow:var(--focus-ring);background:#0f1b30}
:where(input,select,textarea)[aria-invalid="true"]{border-color:var(--err)}

/* ===== Buttons ===== */
button{
  position:relative; cursor:pointer; border:0;
  font-weight:900; letter-spacing:.2px; color:var(--tg-button-text);
  background:linear-gradient(135deg,var(--acc1),var(--acc2));
  box-shadow:0 10px 26px #000b, 0 0 0 0 var(--glow);
  min-height:42px; touch-action:manipulation;
}
button:hover{transform:translateY(-1px); box-shadow:0 14px 30px #000b, 0 0 0 8px var(--glow)}
button:active{transform:translateY(0)}
button:disabled{opacity:.6; cursor:not-allowed}
button.secondary{background:linear-gradient(180deg,#0b1324,#0a111b); color:var(--tg-text); border:1px solid var(--border-strong)}
button.success{background:linear-gradient(135deg,#22c55e,#16a34a)}
button.warn{background:linear-gradient(135deg,#f59e0b,#d97706)}
button.danger{background:linear-gradient(135deg,#ef4444,#b91c1c)}
button.outline{background:transparent;color:var(--tg-text);border:1px solid var(--border-strong)}

/* Glow utility */
.btn-glow{animation:glowPulse 2.4s ease-in-out infinite}
@keyframes glowPulse{50%{filter:drop-shadow(0 0 12px #3aa7ff55)}}

/* Cursor highlight (works even without JS) */
button::after{
  content:""; position:absolute; inset:0; border-radius:inherit; pointer-events:none;
  background:radial-gradient(200px 200px at var(--rx,50%) var(--ry,50%), #fff3, transparent 42%);
  opacity:0; transition:opacity .6s ease;
}
button:where(:hover,:focus-visible)::after{opacity:1}

/* Icon bubble */
.icon{inline-size:24px; block-size:24px; display:grid; place-items:center; border-radius:999px; background:#ffffff12; border:1px solid #ffffff1f; box-shadow:inset 0 1px 0 #ffffff2a}

/* Loading state */
button[data-loading="true"], .btn.loading{pointer-events:none; filter:saturate(.6) grayscale(.2)}
button[data-loading="true"]::before{content:""; position:absolute; inset:0; border-radius:inherit; background:conic-gradient(from 0deg, transparent 0 70%, #fff4 70% 100%); mask:radial-gradient(circle at center, transparent 0 64%, #000 65%); animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(1turn)}}

/* ===== Chat ===== */
.chat{flex:1;min-block-size:180px;overflow:auto;display:flex;flex-direction:column;gap:10px;padding:10px;background:#0a111b;border:1px solid #132033;border-radius:14px;box-shadow:inset 0 1px 0 #ffffff14}
.bubble{max-inline-size:95%;padding:10px 12px;border-radius:14px;font-size:14px;line-height:1.35;animation:bub var(--speed) ease both;box-shadow:0 6px 16px #0007}
@keyframes bub{from{opacity:0;transform:translateY(6px)}}
.bubble .meta{opacity:.7;font-size:12px;margin-top:4px}
.b-user{align-self:flex-end;background:linear-gradient(135deg,#1d2e48,#13253f);border:1px solid #274165}
.b-admin{align-self:flex-start;background:linear-gradient(135deg,#1c3a22,#142818);border:1px solid #2e4a32}
.b-system{align-self:center;background:linear-gradient(135deg,#212636,#161b29);border:1px solid #2b3547}

/* ===== Roulette / Case Strip ===== */
.case-wrap{position:relative;block-size:124px;border:1px solid #132033;border-radius:14px;background:linear-gradient(180deg,#0d1628,#0a111b);overflow:hidden;box-shadow:inset 0 1px 0 #fff1,0 6px 16px #0007}
#case-strip{position:absolute;inset-block-start:0;inset-inline-start:0;block-size:100%;display:flex;gap:10px;will-change:transform;padding:12px}
.case-tile{min-inline-size:120px;block-size:100%;border-radius:12px;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#0f1728;border:1px solid #20314a;box-shadow:inset 0 1px 0 #fff1,0 4px 10px #0006;font-weight:800;font-size:18px;letter-spacing:.3px}
.case-tile .icon{font-size:28px;margin-bottom:4px;filter:drop-shadow(0 0 6px #5aa2ff66)}
#case-pointer{position:absolute;inset-block:0;inset-inline-start:50%;inline-size:0}
#case-pointer::after{content:"";position:absolute;inset-block:0;inset-inline-start:-1px;inline-size:2px;background:linear-gradient(180deg,transparent,#4fa0ff,transparent);box-shadow:0 0 10px #4fa0ff88}
.ru-result{margin-top:8px;font-size:16px}

/* ===== Notifications / Modal — responsive + proper close button ===== */
.notify-root{
  position:fixed; z-index:1000; pointer-events:none;
  inset-block-start:calc(12px + env(safe-area-inset-top));
  inset-inline-end:calc(12px + env(safe-area-inset-right));
  display:flex; flex-direction:column; gap:10px;
  max-height:calc(100svh - 24px - env(safe-area-inset-top));
  overflow:auto; scrollbar-gutter:stable;
}
.notif{
  pointer-events:auto; position:relative; overflow:hidden;  /* clip btn inside */
  inline-size:min(92vw, 420px); min-inline-size:260px; max-inline-size:520px;

  display:grid; grid-template-columns:1fr auto; align-items:start; gap:8px 12px;
  border-radius:var(--radius-sm); padding:12px 12px 12px 14px;
  font-weight:800; color:var(--tg-text);
  background:var(--elev); border:1px solid var(--border-strong);
  box-shadow:var(--shadow), var(--inset);
  animation:notifIn var(--speed-fast) ease-out both;
}
@keyframes notifIn{from{opacity:0;transform:translateY(-8px)}}

.notif .title{grid-column:1/2; font-size:14px; margin:0; opacity:.92}
.notif .msg{grid-column:1/2; font-size:13px; opacity:.85}

.notif .x{
  /* inside the frame, touch-friendly */
  grid-column:2/3; grid-row:1/2; align-self:start; justify-self:end;
  position:static; inline-size:32px; block-size:32px; border-radius:10px;
  background:#0b1324; color:#9fb1cc; cursor:pointer; display:grid; place-items:center;
  border:1px solid var(--border-strong); font-weight:800;
}
.notif .x:hover{filter:brightness(1.08)}
.notif .x:active{transform:translateY(1px)}

.notif.info{border-color:#245ba3}
.notif.success{border-color:#1f6d3a;background:linear-gradient(180deg,#0e1f17,#0b1511)}
.notif.error{border-color:#7b2c2c;background:linear-gradient(180deg,#1a1010,#120b0b)}

.notify-root .notif + .notif{margin-top:0} /* gap already on root */

/* Modal */
.notify-modal{position:fixed;inset:0;z-index:1001;display:grid;place-items:center}
.notify-modal.hidden{display:none}
.notify-backdrop{position:absolute;inset:0;background:#0008;backdrop-filter:blur(2px);animation:fadeBackdrop var(--speed-fast) ease-out both}
@keyframes fadeBackdrop{from{opacity:0}}
.notify-dialog{
  position:relative; z-index:1;
  inline-size:min(92vw, 480px);
  background:var(--panel); border:1px solid var(--border); border-radius:16px; padding:16px;
  box-shadow:0 18px 50px #000a, inset 0 1px 0 #fff2; animation:popIn var(--speed) ease-out both;
}
@keyframes popIn{from{opacity:0; transform:translateY(10px) scale(.98)}}

/* ===== Mobile tweaks ===== */
@media (max-width:600px){
  .notify-root{
    inset:auto 0 calc(12px + env(safe-area-inset-bottom)) 0;
    align-items:center; /* centered toasts */
  }
  .notif{inline-size:clamp(280px, 94vw, 520px)}
}
/* Coarse pointers (phones): soften hover */
@media (pointer:coarse){
  .notif .x:hover{filter:none}
}

/* ===== Pricing / Plans ===== */
.priv-summary{padding:10px;border:1px solid var(--border);border-radius:12px;background:#0a111b}
.plans{display:grid;grid-template-columns:1fr;gap:12px}
@media (min-width:600px){.plans{grid-template-columns:repeat(2,1fr)}}
@media (min-width:900px){.plans{grid-template-columns:repeat(3,1fr)}}
.plan{background:#0f1728;border:1px solid var(--border-strong);border-radius:16px;padding:14px;display:flex;flex-direction:column;gap:10px;box-shadow:inset 0 1px 0 #fff1; animation:cardIn var(--speed) both}
.plan-badge{font-size:12px;color:#a6ceff;background:#0b1324;border:1px solid #274165;border-radius:999px;padding:4px 8px;width:max-content}
.plan-badge.muted{opacity:.8;border-color:#38445f}
.plan-title{font-weight:900;font-size:16px}
.plan-feats{margin:0;padding-inline-start:18px;display:flex;flex-direction:column;gap:4px}
.plan-price{font-weight:900;font-size:18px}
.plan-note{font-size:12px;opacity:.75}
.plan-price.hidden{display:none}

/* ===== Contests ===== */
.contest-list{display:grid;gap:10px}
.contest-card{background:#0f1728;border:1px solid var(--border-strong);border-radius:14px;padding:12px;display:grid;gap:8px; animation:cardIn var(--speed) both}
.contest-title{font-weight:900;font-size:16px}
.contest-meta{font-size:13px;opacity:.85;display:flex;gap:12px;flex-wrap:wrap}
.contest-actions{display:flex;gap:10px;flex-wrap:wrap}
.contest-actions .secondary{background:#0b1324;border:1px solid #2a3960}

/* ===== Utilities ===== */
.hr{block-size:1px;background:linear-gradient(90deg,transparent,var(--border),transparent);border:0;margin:8px 0}
.badge{display:inline-flex;align-items:center;gap:6px;block-size:28px;padding-inline:10px;border-radius:999px;border:1px solid var(--border-strong);background:linear-gradient(180deg,#0b1324,#09101d);font-weight:700;font-size:12px;color:var(--muted)}
.kbd{font:600 12px/1.2 ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;background:#0d1424;padding:4px 6px;border-radius:6px;border:1px solid #2a3960}

/* Skeleton & shimmer */
.skeleton{position:relative;display:block;background:#0f1728;border-radius:8px;min-block-size:1em;overflow:hidden}
.skeleton::after{content:"";position:absolute;inset:0;animation:shimmer 1.4s linear infinite;background:linear-gradient(90deg,transparent, #ffffff10 30%, transparent 60%)}
@keyframes shimmer{from{transform:translateX(-100%)} to{transform:translateX(100%)}}

/* ===== Fancy scroll areas ===== */
.scroll{max-height:inherit; overflow:auto; overscroll-behavior:contain; -webkit-overflow-scrolling:touch; scroll-behavior:smooth; scrollbar-gutter:stable both-edges; background:linear-gradient(180deg,#0e1628,#0a111b); border:1px solid #132033; border-radius:14px; padding:10px; box-shadow:inset 0 1px 0 #ffffff14}

/* ===== Custom scrollbars ===== */
.scroll::-webkit-scrollbar, .card::-webkit-scrollbar, body::-webkit-scrollbar{width:var(--sbw); height:var(--sbw)}
.scroll::-webkit-scrollbar-track, .card::-webkit-scrollbar-track, body::-webkit-scrollbar-track{background:#0a111b; border-radius:10px}
.scroll::-webkit-scrollbar-thumb, .card::-webkit-scrollbar-thumb, body::-webkit-scrollbar-thumb{background:linear-gradient(180deg,#1e3a8a,#1d4ed8); border:2px solid #0a111b; border-radius:10px; box-shadow:0 0 0 1px #2a39603d, 0 4px 12px #0008}
.scroll::-webkit-scrollbar-thumb:hover, .card::-webkit-scrollbar-thumb:hover, body::-webkit-scrollbar-thumb:hover{background:linear-gradient(180deg,#2563eb,#3b82f6)}
*{scrollbar-width:thin; scrollbar-color:#244aa3 #0a111b}

/* ===== Motion/contrast preferences ===== */
@media (prefers-reduced-motion: reduce){ *{animation:none!important; transition:none!important; scroll-behavior:auto!important} }
@media (prefers-contrast: more){
  :root{ --focus-ring:0 0 0 3px #93c5fd; --border-strong:#3d6bb4 }
  button{box-shadow:0 0 0 3px #0004}
  .card{box-shadow:0 0 0 2px #0006}
}

/* ===== Touch heuristic: soften heavy hover effects on coarse pointers ===== */
@media (pointer: coarse){
  button:hover{transform:none; box-shadow:0 10px 26px #000b}
}